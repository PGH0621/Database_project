<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>NewFlix</title>

<style>
body{
  margin:0;
  background:#000;
  color:#fff;
  font-family:Arial, sans-serif;
}

/* HEADER */
header{
  position:fixed;
  top:0;
  width:100%;
  z-index:100;
  padding:18px 40px;
  font-size:32px;
  font-weight:bold;
  color:#E50914;
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:linear-gradient(to bottom, rgba(0,0,0,.85), rgba(0,0,0,0));
}

.filter-btn{
  padding:8px 16px;
  border-radius:20px;
  margin-right:80px;
  background:#111;
  color:#fff;
  border:1px solid #333;
  cursor:pointer;
}

/* HERO VIDEO */
.hero{
  position:relative;
  height:85vh;
  overflow:hidden;
}
.hero video{
  width:100%;
  height:100%;
  object-fit:cover;
}
.hero::after{
  content:"";
  position:absolute;
  inset:0;
  background:linear-gradient(
    to top,
    rgba(0,0,0,.9) 5%,
    rgba(0,0,0,.4) 40%,
    rgba(0,0,0,.1) 70%
  );
}
.hero-content{
  position:absolute;
  left:40px;
  bottom:20%;
  z-index:2;
  max-width:500px;
}
.hero-title{font-size:48px;font-weight:bold}
.hero-desc{font-size:16px;opacity:.85;margin:15px 0}
.hero-buttons button{
  padding:10px 22px;
  border:none;
  border-radius:6px;
  margin-right:10px;
  cursor:pointer;
}
.btn-play{background:#fff;color:#000}
.btn-info{background:rgba(109,109,110,.7);color:#fff}

/* MUTE BUTTON */
.mute-btn{
  position:absolute;
  right:40px;
  bottom:40px;
  z-index:3;
  width:48px;
  height:48px;
  border-radius:50%;
  border:none;
  background:rgba(0,0,0,.6);
  color:#fff;
  font-size:20px;
  cursor:pointer;
}

/* FILTER PANEL */
.filter-panel{
  display:none;
  background:#111;
  margin:90px 40px 10px;
  padding:20px;
  border-radius:8px;
}
.filter-panel.active{display:block}

.filter-group{
  margin-bottom:14px;
  font-size:14px;
}
.filter-group label{
  margin-right:18px;
  cursor:pointer;
}

/* CONTENT */
h2{
  margin-left:40px;
  margin-top:40px;
  font-size:24px;
}

.row{
  display:flex;
  overflow-x:auto;
  padding:20px 40px;
  gap:18px;
}
.row::-webkit-scrollbar{display:none}

.movie-card{
  min-width:230px;
  height:330px;
  background:#111;
  border-radius:8px;
  position:relative;
  transition:.25s;
  overflow:hidden;
}
.movie-card:hover{transform:scale(1.12);z-index:2}

.poster{width:100%;height:100%;object-fit:cover}

.rank{
  position:absolute;
  top:10px;
  left:10px;
  font-size:26px;
  font-weight:bold;
  color:#E50914;
}

.badge-new{
  position:absolute;
  top:10px;
  right:10px;
  background:#E50914;
  padding:4px 8px;
  border-radius:6px;
  font-size:12px;
  font-weight:bold;
}

.info-box{
  position:absolute;
  bottom:0;
  width:100%;
  padding:12px;
  background:linear-gradient(transparent,rgba(0,0,0,.95));
}

.movie-title{font-size:15px;font-weight:bold}
.movie-info{font-size:11px;opacity:.85}
.movie-code{
  font-size:10px;
  opacity:.6;
  margin-top:2px;
}
</style>
</head>

<body>

<header>
  <div>NewFlix</div>
  <div>
    <button class="filter-btn" onclick="location.href='/all'">ì „ì²´ ë³´ê¸°</button>
    <button class="filter-btn" onclick="toggleFilter()">í•„í„°</button>
  </div>
</header>


<!-- ================= HERO (í•„í„° ì—†ì„ ë•Œë§Œ) ================= -->
{% if not filter_active %}
<section class="hero">
  <video id="heroVideo" autoplay muted loop playsinline>
    <source src="/static/videos/zoo.mp4" type="video/mp4">
  </video>

  <div class="hero-content">
    <div class="hero-title">NOW STREAMING</div>
    <div class="hero-desc">
      ì´ë²ˆ ë‹¬ ê°€ì¥ ì£¼ëª©ë°›ëŠ” ì‘í’ˆ<br>
      ê·¹ì¥ì—ì„œ ë°”ë¡œ í™”ì œì˜ ì¤‘ì‹¬
    </div>
    <div class="hero-buttons">
      <button class="btn-play">â–¶ ì¬ìƒ</button>
      <button class="btn-info">â„¹ ìƒì„¸ ì •ë³´</button>
    </div>
  </div>

  <button class="mute-btn" id="muteBtn" onclick="toggleMute()">ğŸ”‡</button>
</section>
{% endif %}

<!-- ================= FILTER PANEL ================= -->
<div id="filterPanel" class="filter-panel">
  <form method="GET">

    <div class="filter-group">
      <strong>ì½˜í…ì¸ </strong><br>
      <label>
        <input type="checkbox" name="only_new" value="1" {% if only_new %}checked{% endif %}>
        ì‹ ê·œ ì½˜í…ì¸ ë§Œ
      </label>
    </div>

    <div class="filter-group">
      <strong>êµ­ê°€</strong><br>
      <label><input type="checkbox" name="country" value="korea" {% if country=='korea' %}checked{% endif %}> êµ­ë‚´</label>
      <label><input type="checkbox" name="country" value="foreign" {% if country=='foreign' %}checked{% endif %}> í•´ì™¸</label>
    </div>

    <div class="filter-group">
      <strong>ê´€ê° ìˆ˜</strong><br>
      <label><input type="checkbox" name="audience" value="100" {% if audience=='100' %}checked{% endif %}> 100ë§Œ+</label>
      <label><input type="checkbox" name="audience" value="500" {% if audience=='500' %}checked{% endif %}> 500ë§Œ+</label>
    </div>

    <div class="filter-group">
      <strong>ì¥ë¥´</strong><br>
      <label><input type="checkbox" name="genre" value="ì• ë‹ˆë©”ì´ì…˜" {% if genre=='ì• ë‹ˆë©”ì´ì…˜' %}checked{% endif %}> ì• ë‹ˆë©”ì´ì…˜</label>
      <label><input type="checkbox" name="genre" value="ì½”ë¯¸ë””" {% if genre=='ì½”ë¯¸ë””' %}checked{% endif %}> ì½”ë¯¸ë””</label>
      <label><input type="checkbox" name="genre" value="SF" {% if genre=='SF' %}checked{% endif %}> SF</label>
      <label><input type="checkbox" name="genre" value="ì•¡ì…˜" {% if genre=='ì•¡ì…˜' %}checked{% endif %}> ì•¡ì…˜</label>
      <label><input type="checkbox" name="genre" value="ë“œë¼ë§ˆ" {% if genre=='ë“œë¼ë§ˆ' %}checked{% endif %}> ë“œë¼ë§ˆ</label>
    </div>

    <button type="submit" class="filter-btn">ì ìš©</button>
  </form>
</div>

<!-- ================= FILTER RESULT SLIDE ================= -->
{% if filter_active %}
<h2>í•„í„° ê²°ê³¼ ğŸ¯</h2>
<div class="row">
  {% for f in filter_results %}
  <a href="/movie/{{ f.movieCd }}" style="text-decoration:none;color:inherit">
    <div class="movie-card">
      <img class="poster" src="/static/posters/{{ f.poster }}">
      <div class="info-box">
        <div class="movie-title">{{ f.movieNm }}</div>
        <div class="movie-info">ëˆ„ì  {{ f.audiAcc }}</div>
        <div class="movie-code">Code: {{ f.movieCd }}</div>
      </div>
    </div>
  </a>
  {% endfor %}
</div>
{% endif %}

<!-- ================= NORMAL MODE ================= -->
{% if not filter_active %}

<h2>{{ selected_year }}ë…„ {{ selected_month }}ì›” ë°•ìŠ¤ì˜¤í”¼ìŠ¤ ğŸ”¥</h2>
<div class="row">
  {% for m in movies %}
  <a href="/movie/{{ m.movieCd }}" style="text-decoration:none;color:inherit">
    <div class="movie-card">
      <img class="poster" src="/static/posters/{{ m.poster }}">
      <div class="rank">{{ m.rank }}</div>
      {% if m.is_new %}<div class="badge-new">NEW</div>{% endif %}
      <div class="info-box">
        <div class="movie-title">{{ m.movieNm }}</div>
        <div class="movie-info">ëˆ„ì  {{ m.audiAcc }}</div>
        <div class="movie-code">Code: {{ m.movieCd }}</div>
      </div>
    </div>
  </a>
  {% endfor %}
</div>

<h2>ì‹ ê·œ ì½˜í…ì¸  ğŸ†•</h2>
<div class="row">
  {% for n in new_contents %}
  <a href="/movie/{{ n.movieCd }}" style="text-decoration:none;color:inherit">
    <div class="movie-card">
      <img class="poster" src="/static/posters/{{ n.poster }}">
      <div class="badge-new">NEW</div>
      <div class="info-box">
        <div class="movie-title">{{ n.movieNm }}</div>
        <div class="movie-code">Code: {{ n.movieCd }}</div>
      </div>
    </div>
  </a>
  {% endfor %}
</div>

{% endif %}

<script>
function toggleFilter(){
  document.getElementById("filterPanel").classList.toggle("active");
}

const video = document.getElementById("heroVideo");
const muteBtn = document.getElementById("muteBtn");

function toggleMute(){
  if(!video) return;
  video.muted = !video.muted;
  muteBtn.textContent = video.muted ? "ğŸ”‡" : "ğŸ”Š";
}
</script>

</body>
</html>
